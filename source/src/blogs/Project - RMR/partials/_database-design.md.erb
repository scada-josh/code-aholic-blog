# การออกแบบฐานข้อมูล RMR
![separate line][1]	

> Note : 
> 
> 1. ลิ้งค์ สำหรับออกแบบฐานข้อมูล [Draw.io](https://www.draw.io/#Drmr)
> 2. ตารางฐานข้อมูลที่เกี่ยวข้อง มีดังนี้
> 		* ตาราง rtu_pin_code_tb
> 		* ตาราง rtu_pin_code_tb

---

## Data Dictionary
![separate line][1]	

**Data Dictionary หรือ พจนานุกรมข้อมูล** คือ ชุดคำอธิบาย data หรือ object ต่างๆที่ได้ถูกจัดเก็บไว้ในระบบฐานข้อมูล เพื่อใช้ในการอ้างอิงและระบุข้อมูล โดยนอกจากจะอธิบายถึงข้อมูลที่ถูกจัดเก็บแล้ว ยังสามารถอธิบายความเชื่อมโยงระหว่าง object แต่ละ object ได้ด้วย

<br/>

<h4><p class="text-center"> <strong><i><ins>DATA DICTIONARY</ins></i></strong> </p></h4>


<table class="table table-striped table-bordered"> 
    <thead> 
        <tr> 
            <th class="text-center">#</th> 
            <th>แฟ้มข้อมูล</th> 
            <th>รายละเอียดข้อมูล</th>
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td class="text-center">1</td> 
            <td>rtu_pin_code_tb</td> 
            <td>ข้อมูลรายละเอียดพื้นฐานเกี่ยวกับ RTU</td> 
        </tr> 
        <tr> 
            <td class="text-center">2</td> 
            <td>rtu_main_tb</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">3</td> 
            <td>ru_details_tb</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">4</td> 
            <td>collect_data_all_tb</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">5</td> 
            <td>CostMainGroup</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">6</td> 
            <td>CostSubGroup</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">7</td> 
            <td>CauseMainGroup</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">8</td> 
            <td>CauseSubGroup</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">9</td> 
            <td>FixType</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">10</td> 
            <td>collect_data_cost_tb</td> 
            <td>xxx</td> 
        </tr> 
        <tr> 
            <td class="text-center">11</td> 
            <td>collect_data_cause_tb</td> 
            <td>xxx</td> 
        </tr> 
    </tbody> 
</table>

<br/>

## ฐานข้อมูล <i>rtu_pin_code_tb</i>
![separate line][1]	

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ฐานข้อมูล `rtu_pin_code_tb` เก็บข้อมูลพื้นฐาน RTU รวมถึงพิกัดที่ตั้งของ RTU ด้วย 

โดยจะเป็นการจับคู่ระหว่าง `rtu_pin_code` กับ `dm_code` ซึ่ง

1. มีวันเริ่มต้นการจัดเก็บ (ฟิลด์ **created_datetime**) <br/>...เพื่อระบุวันเริ่มต้นของการ Mapping ระหว่าง `rtu_pin_code` กับ `dm_code` ซึ่งจะมีผลกับการวิเคราะห์โมดูล **RMR**
2. มีวันสิ้นสุดการจัดเก็บ (ฟิลด์ **end_datetime**) <br/>...เพื่อระบุวันสิ้นสุดของการ Mapping ระหว่าง `rtu_pin_code` กับ `dm_code` ซึ่งจะมีผลกับการวิเคราะห์โมดูล **RMR**
3. มี flag (ฟิลด์ **enable**) <br/>...เพื่อระบุสถานะของการ Mapping ระหว่าง `rtu_pin_code` กับ `dm_code` นั่นหมายความว่าเราจะไม่ลบข้อมูลออกจากระบบ เพื่อนำไปสำหรับวิเคราะห์ข้อมูลย้อนหลังของโมดูล **RMR** นั่นเอง
4. แต่...ท้งนี้ หากเป็นการกรอกข้อมูล หรือการ Mapping ระหว่าง `rtu_pin_code` กับ `dm_code` ผิดพลาด ผู้ใช้สามารถลบข้อมูลการ Mapping ออกจากระบบได้

---


<ul class="nav nav-tabs">
  <li class="active"><a data-toggle="tab" href="#home">MySQL</a></li>
  <li><a data-toggle="tab" href="#menu1">PostGIS</a></li>
</ul>

<div class="tab-content">
  <div id="home" class="tab-pane fade in active">
    <h3>MySQL</h3>
    <p>Script สำหรับฐานข้อมูล MySQL</p>
    
<pre class="prettyprint linenums">
CREATE TABLE IF NOT EXISTS `rtu_pin_code_tb` (
 `id` INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, 
 `rtu_pin_code_dm_code` VARCHAR(32) NOT NULL,
 `rtu_pin_code` VARCHAR(32) NOT NULL,
 `dm_code` VARCHAR(32) NOT NULL,
 `lat` float(11,7),
 `lng` float(11,7),
 `location` VARCHAR(255),
 `enable` VARCHAR(1),
 `created_datetime` DATETIME DEFAULT CURRENT_TIMESTAMP, 
 `modified_datetime` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
 `end_datetime` DATETIME, 
 `remark` VARCHAR(255) ,
 UNIQUE (wlma_rtu_code_dm_code)
) 
</pre>
    
    
  </div>
  <div id="menu1" class="tab-pane fade">
    <h3>PostGIS</h3>
    <p>Script สำหรับฐานข้อมูล PostGIS</p>
    
<pre class="prettyprint linenums">
CREATE TABLE IF NOT EXISTS `rtu_pin_code_tb` (
 `id` INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, 
 `rtu_pin_code_dm_code` VARCHAR(32) NOT NULL,
 `rtu_pin_code` VARCHAR(32) NOT NULL,
 `dm_code` VARCHAR(32) NOT NULL,
 `lat` float(11,7),
 `lng` float(11,7),
 `location` VARCHAR(255),
 `enable` VARCHAR(1),
 `created_datetime` DATETIME DEFAULT CURRENT_TIMESTAMP, 
 `modified_datetime` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
 `end_datetime` DATETIME, 
 `remark` VARCHAR(255) ,
 UNIQUE (wlma_rtu_code_dm_code)
) 
</pre>
  </div>
</div>

<br/>

<table class="table table-striped table-bordered"> 
    <thead> 
        <tr> 
            <th>Field Name</th> 
            <th>Description</th>
            <th>Field Type</th>
            <th>Null</th>
            <th>PK/FK</th>
            <th>Default Value</th>
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>id</td> 
            <td>เลขลำดับ</td> 
            <td>INT(6)</td>
            <td></td>
            <td>PK</td>
            <td></td>
        </tr> 
        <tr> 
            <td>rtu_pin_code_dm_code</td> 
            <td>รหัส pin_code กับ dm_code</td> 
            <td>VARCHAR(32)</td>
            <td>No</td>
            <td>UNIQUE</td>
            <td></td>
        </tr> 
        <tr> 
            <td>rtu_pin_code</td> 
            <td>รหัส pin code ของ RTU</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>dm_code</td> 
            <td>รหัส DM</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>lat</td> 
            <td>latitude</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>lng</td> 
            <td>longitude</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>location</td> 
            <td>สถานที่</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>enable</td> 
            <td>สถานะของการ Mapping (active/inactive)</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>created_datetime</td> 
            <td>วันที่เพิ่มข้อมูล RTU</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>modified_datetime</td> 
            <td>วันที่แก้ไขข้อมูล RTU</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>end_datetime</td> 
            <td>วันสิ้นสุดการจัดเก็บ RTU</td> 
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr> 
        <tr> 
            <td>remark</td> 
            <td>หมายเหตุ</td> 
            <td>VARCHAR(255)</td>
            <td>Yes</td>
            <td></td>
            <td></td>
        </tr> 
    </tbody> 
</table>




[1]: <%= current_page.data.baseURL %>images/blog-common/separate-line.png
[2]: <%= current_page.data.baseURL %>images/blog-common/separate-line-with-indent.png
[3]: <%= current_page.data.baseURL %>images/blog-common/icon-h1.png